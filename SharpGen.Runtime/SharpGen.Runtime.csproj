<Project Sdk="Microsoft.NET.Sdk">

  <Sdk Name="Microsoft.DotNet.PackageValidation" />
  <Sdk Name="Microsoft.Build.CentralPackageVersions" />

  <PropertyGroup>
    <!--
      net6.0 for full assembly trimming
      net5.0 for function pointers codegen and Native(U)Long API surface and partial assembly trimming
      netcoreapp3.0 for smaller [empty] dependency tree (w/o System.Runtime.CompilerServices.Unsafe)
      netstandard2.1 + netcoreapp2.1 for smaller dependency tree (w/o System.Memory)
        netstandard2.1 is .NET Core 3.0, but System.Memory is already inbox since 2.1
      netstandard2.0 for smaller dependency tree than netstandard1.3
      net471 for even smaller dependency tree on latest .NET Framework versions (w/o System.Runtime.InteropServices.RuntimeInformation)
      net46 for using proper FormattableString instead of Shim/* version
      net45 for smaller dependency tree for all .NET Framework versions
      netstandard1.3 is the lowest supported version (except .NET Framework)
    -->
    <TargetFrameworks>net6.0;net5.0;netcoreapp3.0;netstandard2.1;netcoreapp2.1;netstandard2.0;net471;net46;net45;netstandard1.3</TargetFrameworks>
    <Description>Support classes for code generated by SharpGen.</Description>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <CheckEolTargetFramework>false</CheckEolTargetFramework>
    <EnableTrimAnalyzer>true</EnableTrimAnalyzer>
    <EnableNETAnalyzers>true</EnableNETAnalyzers>
    <AnalysisLevel>preview</AnalysisLevel>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="System.Memory" Condition="'$(TargetFramework)' != 'net5.0' and '$(TargetFramework)' != 'net6.0' and '$(TargetFramework)' != 'netcoreapp3.0' and '$(TargetFramework)' != 'netstandard2.1' and '$(TargetFramework)' != 'netcoreapp2.1'" />
    <PackageReference Include="System.Runtime.CompilerServices.Unsafe" Condition="'$(TargetFramework)' != 'net5.0' and '$(TargetFramework)' != 'net6.0' and '$(TargetFramework)' != 'netcoreapp3.0'" />
    <PackageReference Include="System.Runtime.InteropServices.RuntimeInformation" Condition="'$(TargetFramework)' == 'net45' or '$(TargetFramework)' == 'net46' or '$(TargetFramework)' == 'netstandard1.3'" />
    <PackageReference Include="Nullable" Condition="'$(TargetFramework)' != 'net5.0' and '$(TargetFramework)' != 'net6.0'" />
  </ItemGroup>

  <ItemGroup>
    <Content Include="Mapping.xml" PackagePath="build" />
    <Content Include="SharpGen.Runtime.props" PackagePath="build;buildMultiTargeting" />
  </ItemGroup>

  <ItemGroup Condition="'$(TargetFramework)' != 'net45'">
    <Compile Remove="Shim/Formattable*" />
  </ItemGroup>

  <ItemGroup Condition="'$(TargetFramework)' == 'net5.0'">
    <Compile Remove="Shim/ReferenceEqualityComparer.cs" />
  </ItemGroup>

</Project>
